{"ast":null,"code":"const localData = localStorage.getItem('cart');\nexport const initialState = {\n  cart: localData ? JSON.parse(localData) : [],\n  user: null\n};\nexport const getCartTotal = cart => cart === null || cart === void 0 ? void 0 : cart.reduce((amount, item) => item.price * item.amount + amount, 0);\nexport const findProductInCart = (cart, productObj) => {\n  const foundProduct = cart.find(cartItem => cartItem.id === productObj.item.id);\n  const index = cart.findIndex(cartItem => cartItem.id === productObj.item.id);\n  return {\n    foundProduct,\n    index\n  };\n};\nconst reducer = (state, action) => {\n  switch (action.type) {\n    case 'ADD_TO_CART':\n      {\n        const {\n          foundProduct,\n          index\n        } = findProductInCart(state.cart, action);\n        const newCartState = [...state.cart];\n        if (foundProduct) {\n          const updatedProduct = {\n            ...foundProduct,\n            amount: foundProduct.amount + 1\n          };\n          newCartState.splice(index, 1);\n          const newState = [...newCartState, updatedProduct];\n          localStorage.setItem('cart', JSON.stringify(newState));\n          return {\n            ...state,\n            cart: newState\n          };\n        }\n        const newCart = [...state.cart, action.item];\n        localStorage.setItem('cart', JSON.stringify(newCart));\n        return {\n          ...state,\n          cart: [...state.cart, action.item]\n        };\n      }\n    case 'REMOVE_FROM_CART':\n      {\n        const index = state.cart.findIndex(cartItem => cartItem.id === action.id);\n        const newCartState = [...state.cart];\n        if (index >= 0) {\n          newCartState.splice(index, 1);\n        } else {\n          console.warn(`Can't remove product (id: ${action.id}) as its not in the cart`);\n        }\n        localStorage.setItem('cart', JSON.stringify(newCartState));\n        return {\n          ...state,\n          cart: newCartState\n        };\n      }\n    case 'REDUCE_IN_CART':\n      {\n        const {\n          foundProduct,\n          index\n        } = findProductInCart(state.cart, action);\n        if (foundProduct && foundProduct.amount > 0) {\n          const newCartState = [...state.cart];\n          const updatedProduct = {\n            ...foundProduct,\n            amount: foundProduct.amount - 1\n          };\n          newCartState.splice(index, 1);\n          const newState = [...newCartState, updatedProduct];\n          localStorage.setItem('cart', JSON.stringify(newState));\n          return {\n            ...state,\n            cart: newState\n          };\n        }\n        return {\n          ...state\n        };\n      }\n    case 'EMPTY_CART':\n      localStorage.removeItem('cart');\n      return {\n        ...state,\n        cart: []\n      };\n    case 'SET_USER':\n      return {\n        ...state,\n        user: action.user\n      };\n    default:\n      return state;\n  }\n};\nexport default reducer;","map":{"version":3,"names":["localData","localStorage","getItem","initialState","cart","JSON","parse","user","getCartTotal","reduce","amount","item","price","findProductInCart","productObj","foundProduct","find","cartItem","id","index","findIndex","reducer","state","action","type","newCartState","updatedProduct","splice","newState","setItem","stringify","newCart","console","warn","removeItem"],"sources":["/Users/sofiaramil/.Trash/final/online.shop/src/store/reducer.js"],"sourcesContent":["const localData = localStorage.getItem('cart');\nexport const initialState = {\n  cart: localData ? JSON.parse(localData) : [],\n  user: null\n};\n\nexport const getCartTotal = (cart) =>\n  cart?.reduce((amount, item) => item.price * item.amount + amount, 0);\n\nexport const findProductInCart = (cart, productObj) => {\n  const foundProduct = cart.find((cartItem) => cartItem.id === productObj.item.id);\n  const index = cart.findIndex((cartItem) => cartItem.id === productObj.item.id);\n  return { foundProduct, index };\n};\n\nconst reducer = (state, action) => {\n  switch (action.type) {\n    case 'ADD_TO_CART': {\n      const { foundProduct, index } = findProductInCart(state.cart, action);\n      const newCartState = [...state.cart];\n      if (foundProduct) {\n        const updatedProduct = { ...foundProduct, amount: foundProduct.amount + 1 };\n        newCartState.splice(index, 1);\n        const newState = [...newCartState, updatedProduct];\n        localStorage.setItem('cart', JSON.stringify(newState));\n        return {\n          ...state,\n          cart: newState\n        };\n      }\n      const newCart = [...state.cart, action.item];\n      localStorage.setItem('cart', JSON.stringify(newCart));\n      return {\n        ...state,\n        cart: [...state.cart, action.item]\n      };\n    }\n    case 'REMOVE_FROM_CART': {\n      const index = state.cart.findIndex((cartItem) => cartItem.id === action.id);\n      const newCartState = [...state.cart];\n\n      if (index >= 0) {\n        newCartState.splice(index, 1);\n      } else {\n        console.warn(`Can't remove product (id: ${action.id}) as its not in the cart`);\n      }\n      localStorage.setItem('cart', JSON.stringify(newCartState));\n      return {\n        ...state,\n        cart: newCartState\n      };\n    }\n\n    case 'REDUCE_IN_CART': {\n      const { foundProduct, index } = findProductInCart(state.cart, action);\n      if (foundProduct && foundProduct.amount > 0) {\n        const newCartState = [...state.cart];\n        const updatedProduct = { ...foundProduct, amount: foundProduct.amount - 1 };\n        newCartState.splice(index, 1);\n        const newState = [...newCartState, updatedProduct];\n        localStorage.setItem('cart', JSON.stringify(newState));\n        return {\n          ...state,\n          cart: newState\n        };\n      }\n\n      return {\n        ...state\n      };\n    }\n\n    case 'EMPTY_CART':\n      localStorage.removeItem('cart');\n      return {\n        ...state,\n        cart: []\n      };\n\n    case 'SET_USER':\n      return {\n        ...state,\n        user: action.user\n      };\n\n    default:\n      return state;\n  }\n};\n\nexport default reducer;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}